# <center> CS 3640: Introduction to Networks and Their Applications </center>
## <center> Assignment 3: BGP Routing and Hijack Detection [16 points] </center>
<center> Released on: Oct 29th | Due on: Nov 18th 11:59pm</center>
<hr>

### Learning goals
In this assignment, you will work with real BGP router data to build a usable routing table and identify BGP hijack
attempts. In addition to achieving a better understanding of BGP routing and how BGP hijacks work, over the course of 
working on this assignment, you will develop the ability to:
- manipulate IP addresses and subnet prefixes in Python, 
- parse BGP update files in the MRT format, 
- collapse routing tables, and 
- identify suspicious BGP announcements.

<hr>

### About the data
The data you are using for this project is the actual data from this 
[BGP hijack event](https://www.nytimes.com/2008/02/26/technology/26tube.html) that we briefly discussed in class. 
Once the assignment is complete, you will be able to see exactly how Pakistani censors implemented their censorship
of YouTube using BGP, where they went wrong and caused a global YouTube outage, and how YouTube recovered from the 
accidental global censorship.

<hr>

### Assignment overview
There are three classes that you will need to implement: `ParseUpdates`, `RoutingTable`, and `DetectHijacks`. Each of 
these are in their own files. A high-level summary of each class is provided below. More detailed descriptions and 
skeletons of code are provided in the `ParseUpdates.py`, `RoutingTable.py`, and `DetectHijacks.py` files.
- *ParseUpdates*: This class contains methods to parse BGP MRT files that contain route announcements and withdrawals 
from peer ASes. You will need to implement methods to read a supplied MRT file and extract specific information about
announced and withdrawn routes. You will then use this information to build your routing table.
- *RoutingTable*: This class contains methods to apply route information to create, update, and compress a routing 
table. You will need to implement methods to take in BGP announcements and add any new path information to your routing
table, remove any entries that are no longer valid (have been withdrawn by the announcing AS), and compress your routing
table by merging together equivalent entries.
- *DetectHijacks*: This class contains methods to identify and log suspicious BGP announcements. You will need to 
implement methods to check whether an issued update is safe to be applied to your routing table and log information 
about updates that are deemed unsafe. Using these logs, you will be able to understand exactly how BGP hijacks work and
how they can be used to implement censorship. 

<hr>

### Evaluation and submission
For this assignment, you will submit 5 files: 
- completed versions of `ParseUpdates.py`, `RoutingTable.py`, and `DetectHijacks.py`.
- a complete `checkpoint7.md` file in which you use the logs generated by your analysis of the suspicious BGP 
announcements observed to tell the story of the BGP hijack seen in our data.
- a complete `sources.md` file in which you list a link to your **private** GitHub repository, your team's credit reel,
and links to all the resources used to help you complete this assignment.

#### Submitted program [14 points]
The `Tests` class is provided to you to help verify the correctness of your work. To run a test up to checkpoint `X`, 
you will use: `python3 Tests.py -cp X` from the command line. The logs generated by your code can be viewed in the 
`a3-bgp.log` file. A sample of the logs generated from the successful execution of each checkpoint is provided in the 
`./sample-logs/` folder. Points allocated for successfully passing each checkpoint are:

- Checkpoint 1: Reading MRT file updates, parsing route announcements and withdrawals. [3 points]
- Checkpoint 2: Applying route announcements and withdrawals to a routing table. [2 points]
- Checkpoint 3: Measuring the reachability of a routing table. [1 point]
- Checkpoint 4: Collapsing a routing table to save space. [3 points]
- Checkpoint 5: Finding the best path to a destination from a routing table. [2 points]
- Checkpoint 6: Logging suspicious updates and applying safe updates to routing table. [3 points]

#### checkpoint7.md and sources.md [1 point]
- A correct explanation of the sequence of events surrounding the BGP hijack in `checkpoint7.md` [.5 points]. 
- A high-quality credit reel and accurate citations in `sources.md` [.5 points].

#### Individual assessment [1 point]
- Submit a complete and [meaningful evaluation](https://forms.office.com/r/xA9Qt6YC37) of all your team-mates. [1 point]

<hr>

### Important dates 
- **Release date:** Oct 29, 2021
- **Group declaration date:** Nov 2, 2021 (11:59pm). *One member* from each group should send a message on ICON to 
Daniyal, me, and the other teammates letting us know that you will be working together. If you are not part of any 
declared group by this point, we will assume that you will be working alone. I will allow some in-class time to 
facilitate group formation. You may also find it helpful to announce group openings on Piazza. Groups may have no more 
than 5 members (3 is recommended).
- **Due date:** Nov 18, 2021 (11:59pm). Submission is to due on ICON. The credit reel in each part of this assignment must 
clearly indicate the group members and their contributions to discussions and the submitted work. Only one 
submission will be graded for each group -- if multiple submissions are received, only the last submission will be 
graded. Late submissions will be penalized 10% for each day. Assignments may not be submitted after Nov 22, 2021 
(11:59pm).
- **Peer-assessment due date:** Nov 18, 2021 (11:59pm). Late submissions will be penalized at 10% per day. Assessments
may not be submitted after Nov 22, 2021 (11:59pm).

<hr>

### Useful resources
Links to useful resources are provided within each of the classes. Below is some general information to help you get
started.

#### MRT files 
MRT (Multithreaded Router Tool) is the format in which routing protocol messages are stored. The format is defined in 
[RFC6396](https://datatracker.ietf.org/doc/html/rfc6396). The key things to know about MRT files are that each file
can contain many bgp messages communicated by different peers. Each of these can have multiple route announcements
and withdrawals. I have provided a sample MRT file decoded to the JSON format for you to look at 
(`./sample-logs/sample-mrt-in-json.json`). You will find this file helpful while parsing the supplied MRT files. You
may use the `mrtparse` library to help you (`pip3 install mrtparse`). Documentation for this library is available
[here](https://github.com/t2mune/mrtparse).

#### IP address manipulation

You may use the `ipaddress` library (`pip3 install ipaddress`) to help with the manipulation of IP addresses and their
ranges. You may find the `compare_networks`, `subnet_of`, and `collapse_addresses` methods particularly useful when
storing and collapsing address ranges. You can learn more about the other functions of this library 
[here](https://docs.python.org/3/library/ipaddress.html).

<hr>







